<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />



<title>Latent Growth Curve, Genome-Wide Association Study</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<link rel="stylesheet" href="/opt/R/x86_64-pc-linux-gnu-library/4.0/rmarkdown/rmarkdown/templates/html_vignette/resources/vignette.css" type="text/css" />




</head>

<body>




<h1 class="title toc-ignore">Latent Growth Curve, Genome-Wide Association Study</h1>



<p>Suppose you have longitudinal phenotypic measurements and genetic data on the same individuals. The <strong>gwsem</strong> package does not offer a latent growth curve model. Here we demonstrate how to build a latent growth curve model from scratch and perform a genome-wide association test on the slope. Hopefully this demonstration will inspire researchers to incorporate novel structural equation models into genome-wide association studies.</p>
<div id="design-the-model" class="section level2">
<h2>Design the Model</h2>
<p>Visit the <a href="http://onyx.brandmaier.de/">Onyx</a> website. Download Onyx, and create the pictured model.</p>
<div class="figure">
<img src="lgc-onyx.png" alt="LGC Model" />
<p class="caption">LGC Model</p>
</div>
<p>In this model, we have four occasions of measurement for the phenotype (<code>t1</code>, <code>t2</code>, <code>t3</code>, and <code>t4</code>). There are two latent variables, <code>int</code> for the intercept and <code>slope</code> for the slope of the trajectory. The loadings from <code>int</code> to the manifests are all fixed to 1. In contrast, the loadings from <code>slope</code> to the manifests increase. In OpenMx, it is possible to use the actual date of measurement instead of time increments of 1 unit. However, the use of non-unit time increments would force us to estimate the model using maximum likelihood, a method much slower than weighted least squares. So we recommend unit time increments. The single nucleotide polymorphism (SNP) data will appear in the <code>snp</code> indicator. It will be convienent to use exactly the name <code>snp</code> because <strong>gwsem</strong> knows which column to use by its name.</p>
<p>We export the model. This model does not entirely suit our purpose. After copying the code to a file, we remove the bits relating to <code>modelData</code>. We will also need to make a few changes to accomodate covariates. To make these changes easier, we gather up all the <code>mxPath</code> statements into a list.</p>
<div class="figure">
<img src="lgc-export.png" alt="model export" />
<p class="caption">model export</p>
</div>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" title="1"><span class="kw">library</span>(gwsem)  <span class="co"># load gwsem</span></a></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" title="1">manifests&lt;-<span class="kw">c</span>(<span class="st">&quot;t1&quot;</span>,<span class="st">&quot;t2&quot;</span>,<span class="st">&quot;t3&quot;</span>,<span class="st">&quot;t4&quot;</span>,<span class="st">&quot;snp&quot;</span>)</a>
<a class="sourceLine" id="cb2-2" title="2">latents&lt;-<span class="kw">c</span>(<span class="st">&quot;int&quot;</span>,<span class="st">&quot;slope&quot;</span>)</a>
<a class="sourceLine" id="cb2-3" title="3">path &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="kw">mxPath</span>(<span class="dt">from=</span><span class="st">&quot;int&quot;</span>,<span class="dt">to=</span><span class="kw">c</span>(<span class="st">&quot;t1&quot;</span>,<span class="st">&quot;t2&quot;</span>,<span class="st">&quot;t3&quot;</span>,<span class="st">&quot;t4&quot;</span>), <span class="dt">free=</span><span class="kw">c</span>(<span class="ot">FALSE</span>,<span class="ot">FALSE</span>,<span class="ot">FALSE</span>,<span class="ot">FALSE</span>), <span class="dt">value=</span><span class="kw">c</span>(<span class="fl">1.0</span>,<span class="fl">1.0</span>,<span class="fl">1.0</span>,<span class="fl">1.0</span>) , <span class="dt">arrows=</span><span class="dv">1</span>, <span class="dt">label=</span><span class="kw">c</span>(<span class="st">&quot;int__t1&quot;</span>,<span class="st">&quot;int__t2&quot;</span>,<span class="st">&quot;int__t3&quot;</span>,<span class="st">&quot;int__t4&quot;</span>) ),</a>
<a class="sourceLine" id="cb2-4" title="4">                 <span class="kw">mxPath</span>(<span class="dt">from=</span><span class="st">&quot;slope&quot;</span>,<span class="dt">to=</span><span class="kw">c</span>(<span class="st">&quot;t1&quot;</span>,<span class="st">&quot;t2&quot;</span>,<span class="st">&quot;t3&quot;</span>,<span class="st">&quot;t4&quot;</span>), <span class="dt">free=</span><span class="kw">c</span>(<span class="ot">FALSE</span>,<span class="ot">FALSE</span>,<span class="ot">FALSE</span>,<span class="ot">FALSE</span>), <span class="dt">value=</span><span class="kw">c</span>(<span class="fl">0.0</span>,<span class="fl">1.0</span>,<span class="fl">2.0</span>,<span class="fl">3.0</span>) , <span class="dt">arrows=</span><span class="dv">1</span>, <span class="dt">label=</span><span class="kw">c</span>(<span class="st">&quot;slope__t1&quot;</span>,<span class="st">&quot;slope__t2&quot;</span>,<span class="st">&quot;slope__t3&quot;</span>,<span class="st">&quot;slope__t4&quot;</span>) ),</a>
<a class="sourceLine" id="cb2-5" title="5">                 <span class="kw">mxPath</span>(<span class="dt">from=</span><span class="st">&quot;one&quot;</span>,<span class="dt">to=</span><span class="kw">c</span>(<span class="st">&quot;int&quot;</span>,<span class="st">&quot;slope&quot;</span>), <span class="dt">free=</span><span class="kw">c</span>(<span class="ot">TRUE</span>,<span class="ot">TRUE</span>), <span class="dt">value=</span><span class="kw">c</span>(<span class="fl">0.0</span>,<span class="fl">0.0</span>) , <span class="dt">arrows=</span><span class="dv">1</span>, <span class="dt">label=</span><span class="kw">c</span>(<span class="st">&quot;const__int&quot;</span>,<span class="st">&quot;const__slope&quot;</span>) ),</a>
<a class="sourceLine" id="cb2-6" title="6">                 <span class="kw">mxPath</span>(<span class="dt">from=</span><span class="st">&quot;snp&quot;</span>,<span class="dt">to=</span><span class="kw">c</span>(<span class="st">&quot;slope&quot;</span>,<span class="st">&quot;int&quot;</span>), <span class="dt">free=</span><span class="kw">c</span>(<span class="ot">TRUE</span>,<span class="ot">TRUE</span>), <span class="dt">value=</span><span class="kw">c</span>(<span class="fl">1.0</span>,<span class="fl">0.0</span>) , <span class="dt">arrows=</span><span class="dv">1</span>, <span class="dt">label=</span><span class="kw">c</span>(<span class="st">&quot;snp__slope&quot;</span>,<span class="st">&quot;snp__int&quot;</span>) ),</a>
<a class="sourceLine" id="cb2-7" title="7">                 <span class="kw">mxPath</span>(<span class="dt">from=</span><span class="st">&quot;int&quot;</span>,<span class="dt">to=</span><span class="kw">c</span>(<span class="st">&quot;int&quot;</span>), <span class="dt">free=</span><span class="kw">c</span>(<span class="ot">TRUE</span>), <span class="dt">value=</span><span class="kw">c</span>(<span class="fl">1.0</span>) , <span class="dt">arrows=</span><span class="dv">2</span>, <span class="dt">label=</span><span class="kw">c</span>(<span class="st">&quot;VAR_int&quot;</span>) ),</a>
<a class="sourceLine" id="cb2-8" title="8">                 <span class="kw">mxPath</span>(<span class="dt">from=</span><span class="st">&quot;slope&quot;</span>,<span class="dt">to=</span><span class="kw">c</span>(<span class="st">&quot;slope&quot;</span>,<span class="st">&quot;int&quot;</span>), <span class="dt">free=</span><span class="kw">c</span>(<span class="ot">TRUE</span>,<span class="ot">TRUE</span>), <span class="dt">value=</span><span class="kw">c</span>(<span class="fl">1.0</span>,<span class="fl">0.1</span>) , <span class="dt">arrows=</span><span class="dv">2</span>, <span class="dt">label=</span><span class="kw">c</span>(<span class="st">&quot;VAR_slope&quot;</span>,<span class="st">&quot;COV_slope_int&quot;</span>) ),</a>
<a class="sourceLine" id="cb2-9" title="9">                 <span class="kw">mxPath</span>(<span class="dt">from=</span><span class="st">&quot;t1&quot;</span>,<span class="dt">to=</span><span class="kw">c</span>(<span class="st">&quot;t1&quot;</span>), <span class="dt">free=</span><span class="kw">c</span>(<span class="ot">TRUE</span>), <span class="dt">value=</span><span class="kw">c</span>(<span class="fl">1.0</span>) , <span class="dt">arrows=</span><span class="dv">2</span>, <span class="dt">label=</span><span class="kw">c</span>(<span class="st">&quot;VAR_err&quot;</span>) ),</a>
<a class="sourceLine" id="cb2-10" title="10">                 <span class="kw">mxPath</span>(<span class="dt">from=</span><span class="st">&quot;t2&quot;</span>,<span class="dt">to=</span><span class="kw">c</span>(<span class="st">&quot;t2&quot;</span>), <span class="dt">free=</span><span class="kw">c</span>(<span class="ot">TRUE</span>), <span class="dt">value=</span><span class="kw">c</span>(<span class="fl">1.0</span>) , <span class="dt">arrows=</span><span class="dv">2</span>, <span class="dt">label=</span><span class="kw">c</span>(<span class="st">&quot;VAR_err&quot;</span>) ),</a>
<a class="sourceLine" id="cb2-11" title="11">                 <span class="kw">mxPath</span>(<span class="dt">from=</span><span class="st">&quot;t3&quot;</span>,<span class="dt">to=</span><span class="kw">c</span>(<span class="st">&quot;t3&quot;</span>), <span class="dt">free=</span><span class="kw">c</span>(<span class="ot">TRUE</span>), <span class="dt">value=</span><span class="kw">c</span>(<span class="fl">1.0</span>) , <span class="dt">arrows=</span><span class="dv">2</span>, <span class="dt">label=</span><span class="kw">c</span>(<span class="st">&quot;VAR_err&quot;</span>) ),</a>
<a class="sourceLine" id="cb2-12" title="12">                 <span class="kw">mxPath</span>(<span class="dt">from=</span><span class="st">&quot;t4&quot;</span>,<span class="dt">to=</span><span class="kw">c</span>(<span class="st">&quot;t4&quot;</span>), <span class="dt">free=</span><span class="kw">c</span>(<span class="ot">TRUE</span>), <span class="dt">value=</span><span class="kw">c</span>(<span class="fl">1.0</span>) , <span class="dt">arrows=</span><span class="dv">2</span>, <span class="dt">label=</span><span class="kw">c</span>(<span class="st">&quot;VAR_err&quot;</span>) ),</a>
<a class="sourceLine" id="cb2-13" title="13">                 <span class="kw">mxPath</span>(<span class="dt">from=</span><span class="st">&quot;snp&quot;</span>,<span class="dt">to=</span><span class="kw">c</span>(<span class="st">&quot;snp&quot;</span>), <span class="dt">free=</span><span class="kw">c</span>(<span class="ot">TRUE</span>), <span class="dt">value=</span><span class="kw">c</span>(<span class="fl">1.0</span>) , <span class="dt">arrows=</span><span class="dv">2</span>, <span class="dt">label=</span><span class="kw">c</span>(<span class="st">&quot;snp_res&quot;</span>) ),</a>
<a class="sourceLine" id="cb2-14" title="14">                 <span class="kw">mxPath</span>(<span class="dt">from=</span><span class="st">&quot;one&quot;</span>,<span class="dt">to=</span><span class="kw">c</span>(<span class="st">&quot;t1&quot;</span>,<span class="st">&quot;t2&quot;</span>,<span class="st">&quot;t3&quot;</span>,<span class="st">&quot;t4&quot;</span>,<span class="st">&quot;snp&quot;</span>), <span class="dt">free=</span>F, <span class="dt">value=</span><span class="dv">0</span>, <span class="dt">arrows=</span><span class="dv">1</span>))</a>
<a class="sourceLine" id="cb2-15" title="15">model &lt;-<span class="st"> </span><span class="kw">mxModel</span>(<span class="st">&quot;lgc&quot;</span>, </a>
<a class="sourceLine" id="cb2-16" title="16">                 <span class="dt">type=</span><span class="st">&quot;RAM&quot;</span>,</a>
<a class="sourceLine" id="cb2-17" title="17">                 <span class="dt">manifestVars =</span> manifests,</a>
<a class="sourceLine" id="cb2-18" title="18">                 <span class="dt">latentVars =</span> latents,</a>
<a class="sourceLine" id="cb2-19" title="19">                 path)</a></code></pre></div>
</div>
<div id="simulate-fake-data" class="section level2">
<h2>Simulate Fake Data</h2>
<p>Even if we actually had real data, it might be useful to simulate fake data to develop expertise with our model and better understand what to expect from the real analyses. When we built the model in Onyx, we were careful to set starting values that were also appropriate for data simulation. Due to this preparation, data are easily simulated. We simulate <code>N=</code>500 people because this is the amount of fake SNP data available in the <strong>gwsem</strong> package (in the <code>extdata</code> subdirectory).</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" title="1">sim1 &lt;-<span class="st"> </span><span class="kw">mxGenerateData</span>(model, N)</a>
<a class="sourceLine" id="cb3-2" title="2"><span class="kw">head</span>(sim1)</a>
<a class="sourceLine" id="cb3-3" title="3"><span class="co">#&gt;            t1          t2          t3           t4        snp</span></a>
<a class="sourceLine" id="cb3-4" title="4"><span class="co">#&gt; 1 -0.90030568 -2.76207727 -1.74302449  -1.51132454 -0.5517681</span></a>
<a class="sourceLine" id="cb3-5" title="5"><span class="co">#&gt; 2  0.38002682  0.64091402 -2.18280492  -4.05113240 -0.4435763</span></a>
<a class="sourceLine" id="cb3-6" title="6"><span class="co">#&gt; 3  0.81462836  3.05638042  3.94927189   8.22320913  1.4450938</span></a>
<a class="sourceLine" id="cb3-7" title="7"><span class="co">#&gt; 4  0.63561858 -0.09053616 -2.86289891  -6.38403645 -2.2150893</span></a>
<a class="sourceLine" id="cb3-8" title="8"><span class="co">#&gt; 5 -0.05880976 -3.48976930 -6.56627163 -11.22682944 -2.3963544</span></a>
<a class="sourceLine" id="cb3-9" title="9"><span class="co">#&gt; 6  0.34556391 -1.11458800 -0.06797686   0.04056822  0.1383600</span></a></code></pre></div>
<p>A placeholder <code>snp</code> column needs to exist in the <code>sim1</code> <code>data.frame</code>, and will be replaced with each SNP when we run the GWAS. We add some covariates too.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" title="1"><span class="cf">for</span> (ii <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">5</span>) {</a>
<a class="sourceLine" id="cb4-2" title="2">  sim1[[<span class="kw">paste0</span>(<span class="st">&#39;pc&#39;</span>, ii)]] &lt;-<span class="st"> </span><span class="kw">rnorm</span>(N)</a>
<a class="sourceLine" id="cb4-3" title="3">}</a></code></pre></div>
</div>
<div id="model-customization" class="section level2">
<h2>Model Customization</h2>
<p>To add covariates, we need to rebuild the model. To make it easy to rebuild the model, we saved all the <code>mxPath</code> statements in the <code>path</code> list (above). All these paths can be implemented in the new model by including the <code>path</code> list in the model construction. We add <code>mxFitFunctionWLS</code> to select the weighted least squares fit function and add our simulated data.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" title="1">m2 &lt;-<span class="st"> </span><span class="kw">mxModel</span>(<span class="st">&quot;lgc&quot;</span>, <span class="dt">type=</span><span class="st">&quot;RAM&quot;</span>,</a>
<a class="sourceLine" id="cb5-2" title="2">        <span class="dt">manifestVars =</span> model<span class="op">$</span>manifestVars,</a>
<a class="sourceLine" id="cb5-3" title="3">        <span class="dt">latentVars =</span> <span class="kw">c</span>(model<span class="op">$</span>latentVars, <span class="kw">paste0</span>(<span class="st">&#39;pc&#39;</span>, <span class="dv">1</span><span class="op">:</span><span class="dv">5</span>)),</a>
<a class="sourceLine" id="cb5-4" title="4">        path,</a>
<a class="sourceLine" id="cb5-5" title="5">        <span class="kw">mxExpectationRAM</span>(<span class="dt">M=</span><span class="st">&quot;M&quot;</span>),</a>
<a class="sourceLine" id="cb5-6" title="6">        <span class="kw">mxFitFunctionWLS</span>(<span class="dt">allContinuousMethod=</span><span class="st">&quot;marginals&quot;</span>),</a>
<a class="sourceLine" id="cb5-7" title="7">        <span class="kw">mxData</span>(<span class="dt">observed=</span>sim1, <span class="dt">type=</span><span class="st">&quot;raw&quot;</span>, <span class="dt">minVariance=</span><span class="fl">0.1</span>, <span class="dt">warnNPDacov=</span><span class="ot">FALSE</span>))</a></code></pre></div>
<p>At this point, <code>m2</code> almost corresponds with the output of <code>buildOneItem</code> or similar model building function. We just need to set up the covariates.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" title="1">m2 &lt;-<span class="st"> </span><span class="kw">setupExogenousCovariates</span>(m2, <span class="kw">paste0</span>(<span class="st">&#39;pc&#39;</span>, <span class="dv">1</span><span class="op">:</span><span class="dv">5</span>), <span class="kw">paste0</span>(<span class="st">&#39;t&#39;</span>,<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>))</a></code></pre></div>
<p>The model is ready to run. If we had ordinal indicators then we could use <code>setupThresholds</code> to perform some additional set up.</p>
</div>
<div id="running-the-gwas" class="section level2">
<h2>Running the GWAS</h2>
<p>We run the model on the first SNP as a sanity check to ensure that our model is working correctly. The <code>GWAS</code> function writes parameter estimates to the given <code>out.log</code> file, but it also returns the model back to <strong>R</strong>. We can call <code>summary</code> on this model to see the results from the first SNP.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" title="1">tdir &lt;-<span class="st"> </span><span class="kw">tempdir</span>()</a>
<a class="sourceLine" id="cb7-2" title="2">dir &lt;-<span class="st"> </span><span class="kw">system.file</span>(<span class="st">&quot;extdata&quot;</span>, <span class="dt">package =</span> <span class="st">&quot;gwsem&quot;</span>)</a>
<a class="sourceLine" id="cb7-3" title="3">snp1 &lt;-<span class="st"> </span><span class="kw">GWAS</span>(m2, <span class="kw">file.path</span>(dir,<span class="st">&quot;example.pgen&quot;</span>), <span class="kw">file.path</span>(tdir, <span class="st">&quot;out.log&quot;</span>), <span class="dt">SNP=</span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb7-4" title="4"><span class="co">#&gt; Running lgc with 29 parameters</span></a>
<a class="sourceLine" id="cb7-5" title="5"><span class="co">#&gt; Done. See &#39;/tmp/RtmpA0vYb3/out.log&#39; for results</span></a>
<a class="sourceLine" id="cb7-6" title="6"><span class="kw">summary</span>(snp1)</a>
<a class="sourceLine" id="cb7-7" title="7"><span class="co">#&gt; Summary of lgc </span></a>
<a class="sourceLine" id="cb7-8" title="8"><span class="co">#&gt;  </span></a>
<a class="sourceLine" id="cb7-9" title="9"><span class="co">#&gt; free parameters:</span></a>
<a class="sourceLine" id="cb7-10" title="10"><span class="co">#&gt;             name matrix   row   col      Estimate  Std.Error</span></a>
<a class="sourceLine" id="cb7-11" title="11"><span class="co">#&gt; 1       snp__int      A   int   snp  1.346320e-01 0.06260609</span></a>
<a class="sourceLine" id="cb7-12" title="12"><span class="co">#&gt; 2     snp__slope      A slope   snp -1.612135e-02 0.07187524</span></a>
<a class="sourceLine" id="cb7-13" title="13"><span class="co">#&gt; 3      pc1_to_t1      A    t1   pc1  6.345899e-02 0.06131007</span></a>
<a class="sourceLine" id="cb7-14" title="14"><span class="co">#&gt; 4      pc1_to_t2      A    t2   pc1  6.216955e-02 0.09368511</span></a>
<a class="sourceLine" id="cb7-15" title="15"><span class="co">#&gt; 5      pc1_to_t3      A    t3   pc1  1.266260e-01 0.13706537</span></a>
<a class="sourceLine" id="cb7-16" title="16"><span class="co">#&gt; 6      pc1_to_t4      A    t4   pc1  1.745729e-01 0.20093493</span></a>
<a class="sourceLine" id="cb7-17" title="17"><span class="co">#&gt; 7      pc2_to_t1      A    t1   pc2  1.400410e-02 0.06124550</span></a>
<a class="sourceLine" id="cb7-18" title="18"><span class="co">#&gt; 8      pc2_to_t2      A    t2   pc2 -1.663953e-01 0.08995065</span></a>
<a class="sourceLine" id="cb7-19" title="19"><span class="co">#&gt; 9      pc2_to_t3      A    t3   pc2 -2.321053e-01 0.14494158</span></a>
<a class="sourceLine" id="cb7-20" title="20"><span class="co">#&gt; 10     pc2_to_t4      A    t4   pc2 -4.847068e-01 0.20726968</span></a>
<a class="sourceLine" id="cb7-21" title="21"><span class="co">#&gt; 11     pc3_to_t1      A    t1   pc3  1.760877e-02 0.06315163</span></a>
<a class="sourceLine" id="cb7-22" title="22"><span class="co">#&gt; 12     pc3_to_t2      A    t2   pc3  5.117580e-02 0.10116807</span></a>
<a class="sourceLine" id="cb7-23" title="23"><span class="co">#&gt; 13     pc3_to_t3      A    t3   pc3  3.255096e-02 0.15652330</span></a>
<a class="sourceLine" id="cb7-24" title="24"><span class="co">#&gt; 14     pc3_to_t4      A    t4   pc3  5.058980e-02 0.23252581</span></a>
<a class="sourceLine" id="cb7-25" title="25"><span class="co">#&gt; 15     pc4_to_t1      A    t1   pc4 -8.962226e-02 0.06363051</span></a>
<a class="sourceLine" id="cb7-26" title="26"><span class="co">#&gt; 16     pc4_to_t2      A    t2   pc4 -7.390107e-02 0.09292618</span></a>
<a class="sourceLine" id="cb7-27" title="27"><span class="co">#&gt; 17     pc4_to_t3      A    t3   pc4 -8.978333e-03 0.15286037</span></a>
<a class="sourceLine" id="cb7-28" title="28"><span class="co">#&gt; 18     pc4_to_t4      A    t4   pc4  2.750599e-02 0.22062018</span></a>
<a class="sourceLine" id="cb7-29" title="29"><span class="co">#&gt; 19     pc5_to_t1      A    t1   pc5  7.404420e-02 0.06346138</span></a>
<a class="sourceLine" id="cb7-30" title="30"><span class="co">#&gt; 20     pc5_to_t2      A    t2   pc5  9.274255e-02 0.09248299</span></a>
<a class="sourceLine" id="cb7-31" title="31"><span class="co">#&gt; 21     pc5_to_t3      A    t3   pc5  9.359910e-02 0.14637978</span></a>
<a class="sourceLine" id="cb7-32" title="32"><span class="co">#&gt; 22     pc5_to_t4      A    t4   pc5 -1.022803e-01 0.20793700</span></a>
<a class="sourceLine" id="cb7-33" title="33"><span class="co">#&gt; 23       VAR_err      S    t1    t1  1.280021e+00 0.07604163</span></a>
<a class="sourceLine" id="cb7-34" title="34"><span class="co">#&gt; 24       snp_res      S   snp   snp  4.161738e-01 0.01347594</span></a>
<a class="sourceLine" id="cb7-35" title="35"><span class="co">#&gt; 25       VAR_int      S   int   int  8.238928e-01 0.12535132</span></a>
<a class="sourceLine" id="cb7-36" title="36"><span class="co">#&gt; 26 COV_slope_int      S   int slope -5.075074e-02 0.09848424</span></a>
<a class="sourceLine" id="cb7-37" title="37"><span class="co">#&gt; 27     VAR_slope      S slope slope  2.124818e+00 0.16100170</span></a>
<a class="sourceLine" id="cb7-38" title="38"><span class="co">#&gt; 28    const__int      M     1   int -7.436682e-05 0.05743234</span></a>
<a class="sourceLine" id="cb7-39" title="39"><span class="co">#&gt; 29  const__slope      M     1 slope -1.179730e-01 0.07014093</span></a>
<a class="sourceLine" id="cb7-40" title="40"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb7-41" title="41"><span class="co">#&gt; Model Statistics: </span></a>
<a class="sourceLine" id="cb7-42" title="42"><span class="co">#&gt;                |  Parameters  |  Degrees of Freedom  |  Fit (r&#39;Wr units)</span></a>
<a class="sourceLine" id="cb7-43" title="43"><span class="co">#&gt;        Model:             29                   2471             185.3371</span></a>
<a class="sourceLine" id="cb7-44" title="44"><span class="co">#&gt;    Saturated:             20                   2480               0.0000</span></a>
<a class="sourceLine" id="cb7-45" title="45"><span class="co">#&gt; Independence:             10                   2490                   NA</span></a>
<a class="sourceLine" id="cb7-46" title="46"><span class="co">#&gt; Number of observations/statistics: 500/2500</span></a>
<a class="sourceLine" id="cb7-47" title="47"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb7-48" title="48"><span class="co">#&gt; chi-square:  χ² ( df=16 ) = 185.3371,  p = 7.150818e-31</span></a>
<a class="sourceLine" id="cb7-49" title="49"><span class="co">#&gt; CFI: NA </span></a>
<a class="sourceLine" id="cb7-50" title="50"><span class="co">#&gt; TLI: NA   (also known as NNFI) </span></a>
<a class="sourceLine" id="cb7-51" title="51"><span class="co">#&gt; RMSEA:  0.1454893  [95% CI (0.1234642, 0.1682595)]</span></a>
<a class="sourceLine" id="cb7-52" title="52"><span class="co">#&gt; Prob(RMSEA &lt;= 0.05): 1.110223e-16</span></a>
<a class="sourceLine" id="cb7-53" title="53"><span class="co">#&gt; To get additional fit indices, see help(mxRefModels)</span></a>
<a class="sourceLine" id="cb7-54" title="54"><span class="co">#&gt; timestamp: 2020-07-10 20:05:00 </span></a>
<a class="sourceLine" id="cb7-55" title="55"><span class="co">#&gt; Wall clock time: 0.425653 secs </span></a>
<a class="sourceLine" id="cb7-56" title="56"><span class="co">#&gt; OpenMx version number: 2.17.4 </span></a>
<a class="sourceLine" id="cb7-57" title="57"><span class="co">#&gt; Need help?  See help(mxSummary)</span></a></code></pre></div>
<p>This looks alright so we proceed to run all the SNPs and retrieve the results. The <code>loadResults</code> function calculates Z scores and P values for the <code>snp__slope</code> parameter. We might also examine the <code>snp__int</code> parameter.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" title="1"><span class="kw">GWAS</span>(m2, <span class="kw">file.path</span>(dir,<span class="st">&quot;example.pgen&quot;</span>), <span class="kw">file.path</span>(tdir, <span class="st">&quot;out.log&quot;</span>))</a>
<a class="sourceLine" id="cb8-2" title="2"><span class="co">#&gt; Running lgc with 29 parameters</span></a>
<a class="sourceLine" id="cb8-3" title="3"><span class="co">#&gt; Done. See &#39;/tmp/RtmpA0vYb3/out.log&#39; for results</span></a>
<a class="sourceLine" id="cb8-4" title="4">got &lt;-<span class="st"> </span><span class="kw">loadResults</span>(<span class="kw">file.path</span>(tdir, <span class="st">&quot;out.log&quot;</span>), <span class="st">&#39;snp__slope&#39;</span>)</a>
<a class="sourceLine" id="cb8-5" title="5">got &lt;-<span class="st"> </span><span class="kw">signif</span>(got, <span class="st">&#39;snp__slope&#39;</span>)</a></code></pre></div>
<p>Some of the models failed to fit. If we’re interested to discover why then we can load these separately,</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" title="1">susp &lt;-<span class="st"> </span>got[<span class="kw">isSuspicious</span>(got),]</a>
<a class="sourceLine" id="cb9-2" title="2"><span class="kw">head</span>(susp)</a>
<a class="sourceLine" id="cb9-3" title="3"><span class="co">#&gt;    MxComputeLoop1 CHR    BP     SNP A1 A2 statusCode</span></a>
<a class="sourceLine" id="cb9-4" title="4"><span class="co">#&gt; 1:              7   1  8000  RSID_8  G  A       &lt;NA&gt;</span></a>
<a class="sourceLine" id="cb9-5" title="5"><span class="co">#&gt; 2:              9   1 10000 RSID_10  G  A       &lt;NA&gt;</span></a>
<a class="sourceLine" id="cb9-6" title="6"><span class="co">#&gt; 3:             16   1 17000 RSID_17  G  A       &lt;NA&gt;</span></a>
<a class="sourceLine" id="cb9-7" title="7"><span class="co">#&gt; 4:             18   1 19000 RSID_19  G  A       &lt;NA&gt;</span></a>
<a class="sourceLine" id="cb9-8" title="8"><span class="co">#&gt; 5:             20   1 21000 RSID_21  G  A       &lt;NA&gt;</span></a>
<a class="sourceLine" id="cb9-9" title="9"><span class="co">#&gt; 6:             23   1 24000 RSID_24  G  A       &lt;NA&gt;</span></a>
<a class="sourceLine" id="cb9-10" title="10"><span class="co">#&gt;                                                 catch1 snp__slope</span></a>
<a class="sourceLine" id="cb9-11" title="11"><span class="co">#&gt; 1: lgc.data: &#39;snp&#39; has observed variance less than 0.1          1</span></a>
<a class="sourceLine" id="cb9-12" title="12"><span class="co">#&gt; 2: lgc.data: &#39;snp&#39; has observed variance less than 0.1          1</span></a>
<a class="sourceLine" id="cb9-13" title="13"><span class="co">#&gt; 3: lgc.data: &#39;snp&#39; has observed variance less than 0.1          1</span></a>
<a class="sourceLine" id="cb9-14" title="14"><span class="co">#&gt; 4: lgc.data: &#39;snp&#39; has observed variance less than 0.1          1</span></a>
<a class="sourceLine" id="cb9-15" title="15"><span class="co">#&gt; 5: lgc.data: &#39;snp&#39; has observed variance less than 0.1          1</span></a>
<a class="sourceLine" id="cb9-16" title="16"><span class="co">#&gt; 6: lgc.data: &#39;snp&#39; has observed variance less than 0.1          1</span></a>
<a class="sourceLine" id="cb9-17" title="17"><span class="co">#&gt;    Vsnp__slope:snp__slope   Z   P</span></a>
<a class="sourceLine" id="cb9-18" title="18"><span class="co">#&gt; 1:                    NaN NaN NaN</span></a>
<a class="sourceLine" id="cb9-19" title="19"><span class="co">#&gt; 2:                    NaN NaN NaN</span></a>
<a class="sourceLine" id="cb9-20" title="20"><span class="co">#&gt; 3:                    NaN NaN NaN</span></a>
<a class="sourceLine" id="cb9-21" title="21"><span class="co">#&gt; 4:                    NaN NaN NaN</span></a>
<a class="sourceLine" id="cb9-22" title="22"><span class="co">#&gt; 5:                    NaN NaN NaN</span></a>
<a class="sourceLine" id="cb9-23" title="23"><span class="co">#&gt; 6:                    NaN NaN NaN</span></a></code></pre></div>
<p>It looks like these SNPs had a variance below the threshold we specified in <code>mxData</code> (<code>minVariance=0.1</code>).</p>
<p>We can present a Manhattan plot consisting of the models that succeeded,</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" title="1"><span class="kw">plot</span>(got[<span class="op">!</span><span class="kw">isSuspicious</span>(got),])</a></code></pre></div>
<p><img src="growth_files/figure-html/unnamed-chunk-11-1.png" /><!-- --></p>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
